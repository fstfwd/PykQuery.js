PykUtil={},PykUtil.init=function(){this.pushToArray=function(a,b){return 0==a.length?a=[b]:a.push(b),a},this.concat_and_uniq=function(a,b){return void 0!=a&&void 0!=b&&(a=a.concat(b).filter(function(a,b,c){return c.indexOf(a)===b})),a},this.is_exactly_same=function(a,b){if(void 0!=a&&void 0!=b){var c=a.length==b.length&&a.every(function(a,c){return a===b[c]});return c}return!1},this.subtract_array=function(a,b){if(void 0!=a&&void 0!=b)for(var c=0;c<b.length;c++){var d=a.indexOf(b[c]);d>-1&&a.splice(d,1),0===a.length&&(a=void 0)}return a},this.isBlank=function(a){return void 0==a||""==a?!0:!1}};var PykQuery={};PykQuery.global_names=[],PykQuery.local_names=[],PykQuery.list_of_scopes={},PykQuery.query_json={};var queryjson={},query_restore=!0,restoreFilters=function(){for(var a in PykQuery.query_json)for(var b,c=PykQuery.query_json[a],d=PykQuery.list_of_scopes[a][a],e=0;e<c.length;e++)b="local"===d.scope?!1:!0,d.addFilter(c[e],b,d.localdividtriggeringevent,!0)};Object.defineProperty(PykQuery,"query_json",{get:function(){return queryjson},set:function(a){queryjson=a,query_restore&&restoreFilters()}});var setQueryJSON=function(){var a={};for(var b in PykQuery.list_of_scopes)a[b]=PykQuery.list_of_scopes[b][b].filters;PykQuery.query_json=a};PykQuery.init=function(a,b,c,d,e){that=this,PykQuery.list_of_scopes[d]=a;var f,g,h,i,j,k,l,m=e,n=[],o=[],p=["aggregation","unique","select","datatype","global"],q=["local","global"],r=["inbrowser","rumi"],s=new PykUtil.init;if(!(p.indexOf(b)>-1&&q.indexOf(c)>-1&&!s.isBlank(d)&&r.indexOf(e)>-1))return-1==p.indexOf(g)&&console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px",divid+": mode has invalid value. It should be one of "+p),-1==q.indexOf(h)&&console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px",divid+": scope has invalid value. It should be one of "+q),-1==r.indexOf(i)&&console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px",divid+": adapters has invalid value. It should be one of "+r),s.isBlank(divid)&&console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px",divid+": DivID cannot be undefined."),"global"==g&&"global"!=h&&console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px",divid+": scope and mode both should be global."),!1;if(g=b,h=c,i=e,f="local"==h?d.replace("#",""):d,j="global"==h?_.find(PykQuery.global_names,function(a){return a==f}):null,k="local"==h?_.find(PykQuery.local_names,function(a){return a==f}):null,"global"==g&&"global"!=h)return console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px",f+": scope and mode both should be global."),!1;if(void 0==j&&"global"==h)PykQuery.global_names.push(f),flag=!0;else{if(void 0!=k||"local"!=h)return flag=!1,!1;PykQuery.local_names.push(f),flag=!0}var t,u,v,w=[],x=[],y={},z=[],A={},B=2e3,C=[],D=0,E={};switch("global"==g&&"global"==h&&"inbrowser"==i&&Object.defineProperty(this,"rawdata",{get:function(){return u},set:function(a){u=a}}),"local"==h&&"inbrowser"==i&&Object.defineProperty(this,"global_divid_for_raw_data",{get:function(){return v},set:function(a){v=a}}),"rumi"==i&&(Object.defineProperty(this,"rumiparams",{get:function(){return m},set:function(a){m=a}}),Object.defineProperty(this,"dataformat",{get:function(){return data_format},set:function(a){"csv"===a.toLowerCase()||"json"===a.toLowerCase()||"array"===a.toLowerCase()?data_format=a:console.error("The accepted data formats are csv, json and array only. Kindly set a valid data format.")}})),Object.defineProperty(this,"scope",{get:function(){return h}}),g){case"select":Object.defineProperty(this,"select",{get:function(){return z},set:function(a){z=a}});break;case"aggregation":Object.defineProperty(this,"dimensions",{get:function(){return x},set:function(a){_.each(a,function(a){x.push(a)})}}),Object.defineProperty(this,"metrics",{get:function(){return y},set:function(a){if(M(a))for(var b in a)y[b]=a[b]}});break;case"unique":Object.defineProperty(this,"unique",{get:function(){return z},set:function(a){_.each(a,function(a){z.push(a)})}});break;case"datatype":console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","datatype is currently a missing functionality.")}Object.defineProperty(this,"div_id",{get:function(){return f}}),Object.defineProperty(this,"localdividtriggeringevent",{get:function(){return l},set:function(a){l=a}}),Object.defineProperty(this,"filterdata",{get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"limit",{get:function(){return B},set:function(a){B=a}}),Object.defineProperty(this,"mode",{get:function(){return g}}),Object.defineProperty(this,"offset",{get:function(){return D},set:function(a){D=a}}),Object.defineProperty(this,"impacts",{get:function(){return C},set:function(a){K(a)&&C.push(a)}}),Object.defineProperty(this,"alias",{get:function(){return E},set:function(a){if(columns=Object.keys(a),columns.length<1)return void console.warn("Need atleast 1 alias name to add");for(var b in a)a.hasOwnProperty(b)&&(E[b]=a[b])}}),Object.defineProperty(this,"sort",{get:function(){return A},set:function(a){for(var b in a){if(s.isBlank(b))return void console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","Column name is undefined in sort.");(s.isBlank(a[b])||"asc"!=a[b]&&"desc"!=a[b])&&(a[b]="asc")}A=a}}),this.filter=function(){Object.defineProperty(this,"filters",{get:function(){return w},set:function(a){w=a}})},this.addFilter=function(a,b,c,d){this.filters||this.filter(),L(a)&&(b&&"global"==h?F(a,this,d):b&&"local"==h?(a.local_div_id_triggering_event=f,G(a,!1,d),V()):(b||"global"!=h)&&(b||"local"!=h||F(a,!1,d)))};var F=function(a,b,c){for(var d=!0,e=0;e<w.length;e++){var f=w[e];if(f.column_name==a.column_name&&f.condition_type==a.condition_type){if("values"==f.condition_type){var g=s.is_exactly_same(a["in"],f["in"]),h=s.is_exactly_same(a.not_in,f.not_in);if(1==h&&1==g)return console.warn("Clean up your JS: Same filter cannot add"),!1;d=!0;break}if("range"==f.condition_type){var i=a.condition,j=f.condition;if(i.min==j.min&&i.max==j.max&&i.not==j.not)return console.warn("Clean up your JS: Same filter cannot add"),!1;d=!0}}}1==d&&(w.push(a),b&&"global"===b.scope&&b.call()),query_restore=c,c||setQueryJSON(),query_restore=!0},G=function(a){if("local"==h)for(var b=C.length,c=0;b>c;c++){var d=PykQuery.list_of_scopes[C[c]],e=d[C[c]];e.addFilter(a,!0,f)}};this.removeFilter=function(a,b){L(a)&&(b&&"global"==h?H(a,this):b&&"local"==h?I(a,this):(b||"global"!=h)&&(b||"local"!=h||H(a,this)))};var H=function(a,b){for(var c=a.column_name,d=a.condition_type,e=b.filters,f=0;f<e.length;f++)if(e[f].column_name==c&&e[f].condition_type==d)if("values"==d)0===_.difference(e[f].in,a.in).length&&0===_.difference(e[f].not_in,a.not_in).length&&e.splice(f,1),b&&b.call();else if("range"==d){var g=a.min,h=a.max;s.isBlank(g)||s.isBlank(h)||g==e[f].condition.min&&h==e[f].condition.max&&(e.splice(f,1),b&&b.call())}query_restore=!1,setQueryJSON()},I=function(a,b){if("local"==h)for(var c=C.length,d=0;c>d;d++){{var e=PykQuery.list_of_scopes[C[d]];e[C[d]]}H(a,b)}};this.resetFilters=function(){"global"==h?(w=[],this.call(),query_restore=!1,setQueryJSON(),V()):console.error("You cannot reset a local. Please run it on a Global.")},this.resetDimensions=function(){if("local"==h){for(;this.dimensions.length>0;)this.dimensions.pop();query_restore=!1,setQueryJSON()}else console.error("Globals do not have dimensions. Please run it on a local.")},this.resetMetrics=function(){"local"==h?(this.metrics={},query_restore=!1,setQueryJSON()):console.error("Globals do not have metrics. Please run it on a local.")},this.addImpacts=function(a,b){if(K(a)){len=a.length;for(var c=0;len>c;c++)if(C.push(a[c]),J(this,a[c]),b){var d=PykQuery.list_of_scopes[a[c]];J(d[a[c]],this.div_id),related_pykquery=d[a[c]],related_pykquery.impacts=[this.div_id]}}};var J=function(a,b){"inbrowser"===i&&"local"===a.scope&&(a.global_divid_for_raw_data||(a.global_divid_for_raw_data=b))},K=function(a){var b,c=a.length;b="local"===h?"global":"local";for(var d=0;c>d;d++){var e=PykQuery.list_of_scopes[a[d]],f=e[a[d]];if(f&&f.scope===h)return console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","A "+h+" can only impact a "+b+"."),!1}return!0},L=function(a){return 0==Object.keys(a).length?(console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","Empty filter object is not allowed."),!1):s.isBlank(a.column_name)?(console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","'column_name' cannot be empty."),!1):s.isBlank(a.next)||"OR"==a.next||"AND"==a.next?"range"==a.condition_type?s.isBlank(a.condition)?(console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","'condition' cannot be empty."),!1):s.isBlank(a.condition.min)&&s.isBlank(a.condition.max)?(console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","Either 'min' or 'max' or both must always be present."),!1):!0:"values"==a.condition_type?s.isBlank(a.not_in)&&s.isBlank(a["in"])?(console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","Either 'in' or 'not_in' or both must always be present."),!1):void 0!=a.not_in&&void 0!=a["in"]&&0==a.not_in.length&&0==a["in"].length?(console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","Either 'in' or 'not_in' or both must always be present."),!1):!0:(console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px",f+": 'condition_type' must be one of "+["range","values"]+"."),!1):(console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","'next' must either be empty or OR or AND."),!1)},M=function(a){var b=["min","max","avg","sum","median","count"];if(0==Object.keys(a).length)return console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","'metrics' object cannot be empty."),!1;for(var c in a){if(s.isBlank(c))return console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","Column name is undefined in 'metrics'."),!1;if(s.isBlank(a[c])||0==a[c].length)return console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","Please pass an Array of metric functions for column name '"+c+"'."),!1;for(var d=a[c].length,e=0;d>e;e++)if(b.indexOf(a[c][e])<=-1)return console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","Wrong metric function passed for column name '"+c+"'."),!1}return!0};this.flushToGet=function(){if("local"==h){var a=t;return t="",a}console.error("Cannot call flushToGet to on a Global PykQuery.")},this.call=function(){var a=this;if("local"==h)P(Q(a)),S(a),U();else for(var b=C.length,c=0;b>c;c++){var d=PykQuery.list_of_scopes[C[c]],e=d[C[c]];e.filter_data=e.call()}return!0};var N=function(){if("local"==h){for(var a=PykQuery.list_of_scopes[f],b=a[f].filters,c=C.length,d=0;c>d;d++){var a=PykQuery.list_of_scopes[C[d]],e=a[C[d]].filters;e&&e.localdividtriggeringevent!==f&&(b=_.flatten(e,b))}return b}console.error("Cannot call generateConsolidatedFiltersArray on a Global PykQuery.")},O=function(){if("local"==h){var a=[];if(n&&n.length>0){var b=[],c=[],d=_.groupBy(n,function(a){return a.column_name+"-"+a.condition_type});for(var e in d){for(var f=d[e],g={column_name:f[0].column_name,condition_type:f[0].condition_type,local_div_id_triggering_event:f[0].local_div_id_triggering_event},i=0;i<f.length;i++)b=f[i].in?_.union(b,f[i].in):b,c=f[i].not_in?_.union(c,f[i].not_in):c;g.in=b,g.not_in=c}a.push(g)}else a=[];return a}console.error("Cannot call generateConsolidatedFiltersArray on a Global PykQuery.")},P=function(a){if(n=N(),o=O(),"inbrowser"==i){var b=new PykQuery.adapter.inbrowser.init(a,o);return t=b.call(),t=R(t)}var b=new PykQuery.adapter.rumi.init(a,m);return b.call(function(a){return t=a,t=R(t)})},Q=function(a){var b={},c=Object.getOwnPropertyNames(a);for(var d in c)0==a.propertyIsEnumerable(c[d])&&(b[c[d]]=a[c[d]]);return b};this.storeObjectInMemory=function(a){document.getElementById(f).setAttribute("pyk_object",a)};var R=function(a){var b=PykQuery.list_of_scopes[f],c=b[f].alias;a=JSON.stringify(a);for(var d in c){var e=new RegExp(d,"g");a=a.replace(e,c[d])}return a=JSON.parse(a)},S=function(a){var b=(PykQuery.list_of_scopes[C[0]],PykQuery.list_of_scopes[a.div_id]);if("object"==typeof o)if(0===o.length)T(b);else for(var c=0;c<o.length;c++)o[c].local_div_id_triggering_event!==f&&T(b);else b.hasOwnProperty("execute")&&b.execute()},T=function(a){a.hasOwnProperty("refresh")?a.refresh():a.hasOwnProperty("execute")&&a.execute()},U=function(){if(n){for(var a=document.querySelectorAll(".pykquery-selected"),b=0;b<a.length;b++)a[b].className=a[b].className.replace("pykquery-selected","");for(var b=0;b<n.length;b++)if(n[b].selected_dom_id){var c=document.querySelectorAll("[data-id='"+n[b].selected_dom_id+"']");c.length>0&&!c[0].classList.contains("pykquery-selected")&&(c[0].className+=" pykquery-selected")}}};this.toSql=function(){that=this;var a,b,c=that.filters,d=that.mode,e=that.unique,f=that.metrics,g=that.select,h=that.sort,i=that.dimensions,j=that.limit,k=that.offset,l=that.div_id,m="__",n=that.columns,o=[],p=[],q=[],r="",s="FROM "+m+" ",t=[],u="",v="",w="",x="",y=!1;if(i&&"aggregation"==d){if(f&&0==_.isEmpty(f))for(var z in f){len=f[z].length;for(var A=0;len>A;A++)o.push(f[z][A]+"("+z+")")}if(0==_.isEmpty(i))for(var z=0;z<i.length;z++)0==_.has(f,i[z])&&(o.push(i[z]),p.push(i[z]))}if(g&&"select"==d){if(0===_.intersection(n,g).length&&g.toString()!==["*"].toString())return!1;_.each(g,function(a){o.push(a)})}if(e&&"unique"==d){if(0===_.intersection(n,e).length)return!1;_.each(e,function(a){o.push(a)})}if(r=1==_.isEmpty(o)&&1==_.isEmpty(i)&&"unique"!=d?"SELECT * ":"unique"==d?"SELECT DISTINCT "+o.join(", ")+" ":"SELECT "+o.join(", ")+" ",c&&0==_.isEmpty(c)&&(a=!1,_.each(c,function(d,e){switch(t[e]="",d.condition_type){case"values":b=[],d["in"]&&0!==d["in"].length&&(y=!0,t[e]+=d.column_name+" IN (",_.each(d["in"],function(a){t[e]+=a+", "}),t[e]=t[e].slice(0,-2)+") "),d.not_in&&0!==d.not_in.length&&(t[e]+=y?"AND "+d.column_name+" NOT IN (":d.column_name+" NOT IN (",_.each(d.not_in,function(a){t[e]+=a+", "}),t[e]=t[e].slice(0,-2)+") "),d.next&&e!=c.length-1?(t[e]=t[e]+d.next,a=d.next):a=!1;break;case"range":0==_.isEmpty(d.condition)&&(t[e]+=d.column_name+" ",d.condition.not&&(t[e]+="NOT "),t[e]+="BETWEEN "+d.condition.min+" AND "+d.condition.max+" ",d.next&&e!=c.length-1?(t[e]=t[e]+d.next,a=d.next):a=!1);break;case"data_types":}})),i&&"aggregation"===d&&(u="GROUP BY "+p.join(", ")+" "),h&&0==_.isEmpty(h)){v="ORDER BY ";for(key in h)v+=key+" "+h[key]+", ";v=v.slice(0,-2)+" "}w=j?"LIMIT "+j+" ":w,x=k?"OFFSET "+k+" ":x,q=l+": \n "+r+" \n "+s+" \n WHERE";for(var B=t.length,z=0;B>z;z++)q=q+" \n	 "+t[z];return q=q+" \n "+u+" \n "+v+" \n "+w+" \n "+x,console.log(q),q},this.filterList=function(a){document.getElementById(a).innerHTML="",document.getElementById(a).innerHTML="<div class='filter_list'></div>",V()};var V=function(){document.getElementsByClassName("filter_list")[0].innerHTML="";for(var a=0;a<n.length;a++){var b=document.createElement("div");b.setAttribute("class","filter_block"),b.setAttribute("id","filter_block"+a),document.getElementsByClassName("filter_list")[0].appendChild(b);var c=document.createElement("div");c.setAttribute("class","filter_value"),c.innerHTML="Filter by "+(n[a].in||n[a].not_in),document.getElementById("filter_block"+a).appendChild(c);var d=document.createElement("div");d.setAttribute("class","filter_remove"),d.setAttribute("id","filter_remove_"+a),d.innerHTML="Remove",document.getElementById("filter_block"+a).appendChild(d)}for(var e=document.getElementsByClassName("filter_remove"),a=0;a<e.length;a++)e[a].onclick=function(){var a=this.id.split("_");W(n[a[2]])}},W=function(a){var b=a.local_div_id_triggering_event;id=PykQuery.list_of_scopes[b][b].global_divid_for_raw_data,PykQuery.list_of_scopes[id][id].removeFilter(a,!0),V()}},PykQuery.adapter=PykQuery.adapter||{},PykQuery.adapter.rumi={},PykQuery.adapter.rumi.init=function(a,b){this.call=function(d){if(!c(b))return!1;var e={config:a,filename:b.filename,username:b.username,projectname:b.projectname};$.ajax({url:"http://192.168.0.121:9292/v1/filter/show",data:e,dataType:"json",type:"POST",async:!1,success:function(a){d(a)},error:function(){console.log("Save error.")}})};var c=function(a){var b=new PykUtil.init;return console.log(b.isBlank(a)),void 0==a?(console.error("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","Empty rumi parameter object is not allowed."),!1):b.isBlank(a.filename)?(console.log("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","filename missing in rumi parameter"),!1):b.isBlank(a.username)?(console.log("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","username missing in rumi parameter"),!1):b.isBlank(a.projectname)?(console.log("%c[Error - PykQuery] ","color: red;font-weight:bold;font-size:14px","projectname missing in rumi parameter"),!1):!0}},PykQuery.adapter=PykQuery.adapter||{},PykQuery.adapter.inbrowser={},PykQuery.adapter.inbrowser.init=function(a,b){var c,d=a,e=a.global_divid_for_raw_data,f=PykQuery.list_of_scopes[e];e=f[e],c=e.rawdata,d.filters=b,this.call=function(){var b,c=a.mode;switch(d&&d.filters.length>0&&m(d),c){case"aggregation":b=g(d);break;case"unique":break;case"datatype":}return b};var g=function(a){var b=a.metrics;local_data=_.groupBy(c,a.dimensions[0]);for(var d in b){switch(b[d][0]){case"count":local_data=h(local_data,d);break;case"sum":local_data=i(local_data,d);break;case"min":local_data=j(local_data,d);break;case"max":local_data=k(local_data,d);break;case"extent":local_data=l(local_data,d)}return local_data}},h=function(b,c){var d=[];return _.map(b,function(b,e){var f={};f[a.dimensions[0]]=e,f[c]=b.length,d.push(f)}),d},i=function(b,c){var d=[];return _.map(b,function(b,e){var f={};f[a.dimensions[0]]=e,f[c]=_.sum(b,function(a){return parseInt(a[c],10)}),d.push(f)}),d},j=function(a,b){var c=[];return _.map(a,function(a,d){var e={};e[b]=d,c.push(e),e.min=_.min(a,function(a){return a[b]}),c.push(e)}),c},k=function(a,b){var c=[];return _.map(a,function(a,d){var e={};e[b]=d,c.push(e),e.max=_.max(a,function(a){return a[b]}),c.push(e)}),c},l=function(a,b){var c=[];return _.map(a,function(a,d){var e={};e[b]=d,c.push(e),e.extent=_.extent(a,function(a){return a[b]}),c.push(e)}),c},m=function(a){var b,d=a.mode,e=a.filters,f=e.length;b="select"==a.mode?a.select:[];for(var g=0;f>g;g++)switch(e[g].condition_type){case"values":console.log("---- value code"),n(e[g],b,d);break;case"range":console.log("---- range code"),o(e[g],b);break;case"datatype":}return c},n=function(a,b,d){var e=a["in"],f=a.not_in,g=a.column_name;c=_.filter(c,function(a){return!f||f.indexOf(a[g])<0?a:void 0}),c=_.filter(c,function(a){return e&&e.indexOf(a[g])>-1?a:void 0}),0!=b.length&&"select"===d&&(c=_.map(c,function(a){return _.pick(a,b)}))},o=function(a,b,d){var e=a.condition.min,f=a.condition.max,g=a.column_name;c=_.filter(c,function(a){return a[g]<=f&&a[g]>=e?a:void 0}),0!=b.length&&"select"===d&&(c=_.map(c,function(a){return _.pick(a,b)}))}},this.toSql=function(){that=this;var a,b,c=that.filters,d=that.mode,e=that.unique,f=that.metrics,g=that.select,h=that.sort,i=that.dimensions,j=that.limit,k=that.offset,l=that.div_id,m="__",n=that.columns,o=[],p=[],q=[],r="",s="FROM "+m+" ",t=[],u="",v="",w="",x="",y=!1;if(i&&"aggregation"==d){if(f&&0==_.isEmpty(f))for(var z in f){len=f[z].length;for(var A=0;len>A;A++)o.push(f[z][A]+"("+z+")")}if(0==_.isEmpty(i))for(var z=0;z<i.length;z++)0==_.has(f,i[z])&&(o.push(i[z]),p.push(i[z]))}if(g&&"select"==d){if(0===_.intersection(n,g).length&&g.toString()!==["*"].toString())return!1;_.each(g,function(a){o.push(a)})}if(e&&"unique"==d){if(0===_.intersection(n,e).length)return!1;_.each(e,function(a){o.push(a)})}if(r=1==_.isEmpty(o)&&1==_.isEmpty(i)&&"unique"!=d?"SELECT * ":"unique"==d?"SELECT DISTINCT "+o.join(", ")+" ":"SELECT "+o.join(", ")+" ",c&&0==_.isEmpty(c)&&(a=!1,_.each(c,function(d,e){switch(t[e]="",d.condition_type){case"values":b=[],d["in"]&&0!==d["in"].length&&(y=!0,t[e]+=d.column_name+" IN (",_.each(d["in"],function(a){t[e]+=a+", "}),t[e]=t[e].slice(0,-2)+") "),d.not_in&&0!==d.not_in.length&&(t[e]+=y?"AND "+d.column_name+" NOT IN (":d.column_name+" NOT IN (",_.each(d.not_in,function(a){t[e]+=a+", "}),t[e]=t[e].slice(0,-2)+") "),d.next&&e!=c.length-1?(t[e]=t[e]+d.next,a=d.next):a=!1;break;case"range":0==_.isEmpty(d.condition)&&(t[e]+=d.column_name+" ",d.condition.not&&(t[e]+="NOT "),t[e]+="BETWEEN "+d.condition.min+" AND "+d.condition.max+" ",d.next&&e!=c.length-1?(t[e]=t[e]+d.next,a=d.next):a=!1);break;case"data_types":}})),i&&"aggregation"===d&&(u="GROUP BY "+p.join(", ")+" "),h&&0==_.isEmpty(h)){v="ORDER BY ";for(key in h)v+=key+" "+h[key]+", ";v=v.slice(0,-2)+" "}w=j?"LIMIT "+j+" ":w,x=k?"OFFSET "+k+" ":x,q=l+": \n "+r+" \n "+s+" \n WHERE";for(var B=t.length,z=0;B>z;z++)q=q+" \n	 "+t[z];return q=q+" \n "+u+" \n "+v+" \n "+w+" \n "+x,console.log(q),q},this.returnsWhereClause=function(a){var b="";switch(a.condition_type){case"values":vals=[],a["in"]&&0!==a["in"].length&&(is_IN=!0,b+=a.column_name+" IN (",_.each(a["in"],function(a){b+=a+", "}),b=b.slice(0,-2)+") "),a.not_in&&0!==a.not_in.length&&(b+=is_IN?"AND "+a.column_name+" NOT IN (":a.column_name+" NOT IN (",_.each(a.not_in,function(a){b+=a+", "}),b=b.slice(0,-2)+") ");break;case"range":0==_.isEmpty(a.condition)&&(b+=a.column_name+" ",a.condition.not&&(b+="NOT "),b+="BETWEEN "+a.condition.min+" AND "+a.condition.max+" ");break;case"data_types":}return b};