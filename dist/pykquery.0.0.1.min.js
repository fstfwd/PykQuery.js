function filterDbQueryString(){$.getJSON("../data/test1data.json",function(){})}PykUtil={},PykUtil.init=function(){this.pushToArray=function(a,b){return 0==a.length?a=[b]:a.push(b),a},this.concat_and_uniq=function(a,b){return void 0!=a&&void 0!=b&&(a=a.concat(b).filter(function(a,b,c){return c.indexOf(a)===b})),a},this.is_exactly_same=function(a,b){if(void 0!=a&&void 0!=b){var c=a.length==b.length&&a.every(function(a,c){return a===b[c]});return c}return!1},this.subtract_array=function(a,b){if(void 0!=a&&void 0!=b)for(var c=0;c<b.length;c++){var d=a.indexOf(b[c]);d>-1&&a.splice(d,1)}return a},this.isBlank=function(a){}};var PykQuery={};PykQuery.global_names=[],PykQuery.local_names=[],PykQuery.init=function(a,b,c,d){that=this;var e,f,g,h,i,j,k=["aggregation","unique","select","datatype","global"],l=["local","global"],m=["inbrowser","rumi"],n=new PykUtil.init;if(!(k.indexOf(a)>-1&&l.indexOf(b)>-1&&!n.isBlank(c)&&m.indexOf(d)>-1))return-1==k.indexOf(f)&&console.error(divid+": available_mode has invalid value. It should be one of "+k),-1==l.indexOf(g)&&console.error(divid+": available_scope has invalid value. It should be one of "+l),-1==m.indexOf(h)&&console.error(divid+": available_adapters has invalid value. It should be one of "+m),n.isBlank(divid)&&console.error(divid+": DivID cannot be undefined."),"global"==f&&"global"!=g&&console.error(divid+": scope and mode both should be global."),!1;if(f=a,g=b,h=d,e="local"==g?c.replace("#",""):c,i="global"==g?_.find(PykQuery.global_names,function(a){return a==e}):null,j="local"==g?_.find(PykQuery.local_names,function(a){return a==e}):null,"global"==f&&"global"!=g)return console.error(e+": scope and mode both should be global."),!1;if(void 0==i&&"global"==g)PykQuery.global_names.push(e),flag=!0;else{if(void 0!=j||"local"!=g)return flag=!1,!1;PykQuery.local_names.push(e),flag=!0}var o,p,q,r=[],s=[],t={},u=[],v={},w=2e3,x=[],y=0,z=[];switch("global"==f&&"global"==g&&"inbrowser"==h&&Object.defineProperty(this,"rawdata",{get:function(){return p},set:function(a){p=a}}),"local"==g&&"inbrowser"==h&&Object.defineProperty(this,"global_divid_for_raw_data",{get:function(){return q},set:function(a){q=a}}),"rumi"==h&&Object.defineProperty(this,"datastoreurl",{get:function(){return data_store_url},set:function(a){data_store_url=a}}),Object.defineProperty(this,"scope",{get:function(){return g}}),f){case"select":Object.defineProperty(this,"select",{get:function(){return u},set:function(a){u=a}});break;case"aggregation":Object.defineProperty(this,"dimensions",{get:function(){return s},set:function(a){s.push(a)}}),Object.defineProperty(this,"metrics",{get:function(){return t},set:function(a){if(G(a))for(var b in a)t[b]=a[b]}});break;case"unique":Object.defineProperty(this,"unique",{get:function(){return u},set:function(a){u.push(a)}});break;case"datatype":return void console.error("missing functionality")}Object.defineProperty(this,"div_id",{get:function(){return e}}),Object.defineProperty(this,"filterdata",{get:function(){return o},set:function(a){o=a}}),Object.defineProperty(this,"limit",{get:function(){return w},set:function(a){w=a}}),Object.defineProperty(this,"mode",{get:function(){return f}}),Object.defineProperty(this,"offset",{get:function(){return y},set:function(a){y=a}}),Object.defineProperty(this,"impacts",{get:function(){return x},set:function(a){E(a)&&x.push(a)}}),Object.defineProperty(this,"alias",{get:function(){return z},set:function(a){var b=a.length;if(1>b)return void console.warn("Need atleast 1 alias name to add");for(var c=0;b>c;c++)z.push(a[c])}}),Object.defineProperty(this,"sort",{get:function(){return v},set:function(a){for(var b in a){if(n.isBlank(b))return void console.error("Column name is undefined in sort.");(n.isBlank(a[b])||"asc"!=a[b]&&"desc"!=a[b])&&(a[b]="asc")}v=a}}),this.filter=function(){Object.defineProperty(this,"filters",{get:function(){return r},set:function(a){B(a)}});var a={add:function(a){F(a)&&(A(a),"local"==g&&B(a))},remove:function(a,b,c){C(a,b,c),D(a,b,c)}};return a},this.addImpacts=function(a,b){if(E(a)){len=a.length;for(var c=0;len>c;c++)x.push(a[c]),b&&(related_pykquery=window[a[c]],related_pykquery.impacts=[this.div_id])}};var A=function(a){for(var b=!0,c=0;c<r.length;c++){var d=r[c];if(d.column_name==a.column_name&&d.condition_type==a.condition_type){if("values"==d.condition_type){var e=n.is_exactly_same(a["in"],d["in"]),f=n.is_exactly_same(a.not_in,d.not_in);if(1==f&&1==e)return console.warn("Clean up your JS: Same filter cannot add"),!1;d["in"]=n.concat_and_uniq(d["in"],a["in"]),d.not_in=n.concat_and_uniq(d.not_in,a.not_in),r[c]=d,b=!1;break}if("range"==d.condition_type){var g=a.condition,h=d.condition;if(g.min==h.min&&g.max==h.max&&g.not==h.not)return console.warn("Clean up your JS: Same filter cannot add"),!1;b=!0}}}1==b&&r.push(a)},B=function(a){if("local"==g)for(var b=x.length,c=0;b>c;c++){console.log(x[c]);var d=window[x[c]];d.filters=a}},C=function(a,b,c){for(var d=r.length,e=0;d>e;e++)if(r[e].column_name==a&&r[e].condition_type==b)if("values"==b)r[e]["in"]=n.subtract_array(r[e]["in"],c["in"]),r[e].not_in=n.subtract_array(r[e].not_in,c.not_in);else if("range"==b){var f=c.min,g=c.max;n.isBlank(f)||n.isBlank(g)||f==r[e].condition.min&&g==r[e].condition.max&&r.splice(e,1)}},D=function(a,b,c){if("local"==g)for(var d=impacts.length,e=0;d>e;e++){var f=window[impacts[e]];f.removeFilterInQuery(a,b,c)}},E=function(a){var b,c=a.length;b="local"===g?"global":"local";for(var d=0;c>d;d++){var e=window[a[d]];if(e&&e.scope===g)return console.error("A "+g+" can only impact "+b+"."),!1}return!0},F=function(a){return 0==Object.keys(a).length?(console.error("Empty filter object is not allowed."),!1):n.isBlank(a.column_name)?(console.error("column_name cannot be empty."),!1):n.isBlank(a.next)||"OR"==a.next||"AND"==a.next?"range"==a.condition_type?n.isBlank(a.condition)?(console.error("condition cannot be empty."),!1):n.isBlank(a.condition.min)&&n.isBlank(a.condition.max)?(console.error("Either min or max or both must always be present."),!1):!0:"values"==a.condition_type?n.isBlank(a.not_in)&&n.isBlank(a["in"])?(console.error("Either in or not_in or both must always be present."),!1):void 0!=a.not_in&&void 0!=a["in"]&&0==a.not_in.length&&0==a["in"].length?(console.error("Either in or not_in or both must always be present."),!1):!0:(console.error(e+": condition_type must be one of "+["range","values"]),!1):(console.error("next must either be empty or OR or AND."),!1)},G=function(a){var b=["min","max","avg","sum","median","count"];if(0==Object.keys(a).length)return console.error("Metrics object cannot be empty."),!1;for(var c in a){if(n.isBlank(c))return console.error("Column name is undefined in metrics."),!1;if(n.isBlank(a[c])||0==a[c].length)return console.error("Please pass an Array of metric functions for column name"+c),!1;for(var d=a[c].length,e=0;d>e;e++)if(b.indexOf(a[c][e])<=-1)return console.error("Wrong metric function passed for column name"+c),!1}return!0};this.call=function(){if("local"==g)filterdata=H(this.getConfig());else{filterdata=H(this.getConfig());for(var a=impacts.length,b=0;a>b;b++){var c=window[impacts[b]];c.filterdata=c.call()}}};var H=function(a){if("inbrowser"==h)var b=new PykQuery.adapter.inbrowser.init(a);else var b=new PykQuery.adapter.rumi.init(a);var c=b.call();return c};this.getConfig=function(){var a={},b=Object.getOwnPropertyNames(this);for(var c in b)0==this.propertyIsEnumerable(b[c])&&(a[b[c]]=this[b[c]]);return a},this.storeObjectInMemory=function(a){$("#"+e).attr("pyk_object",a)}},PykQuery-adapter.rumi={},PykQuery.adapter.rumi.init=function(){},PykQuery.adapter.inbrowser={},PykQuery.adapter.inbrowser.init=function(a){global_divid_for_raw_data=window[a.global_divid_for_raw_data],raw_data=global_divid_for_raw_data.rawdata,console.log(raw_data,global_divid_for_raw_data)};